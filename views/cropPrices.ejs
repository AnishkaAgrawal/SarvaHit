<%- include("./partials/head.ejs",{pageTitle }) %>

<body class="min-h-screen bg-gradient-to-br from-green-50 via-emerald-50 to-lime-50 text-gray-900">
  <%- include("./partials/nav2.ejs", { currentPage: "crop" }) %>

  <!-- Header -->
  <header class="text-center mt-10 mb-8">
    <h1 class="text-green-800 text-5xl font-extrabold tracking-tight drop-shadow-sm">
      ğŸŒ¾ Sarvahit - Crop Insights
    </h1>
    <p class="text-gray-600 text-lg mt-2 font-medium">
      Stay updated with real-time crop prices, weather, and market trends
    </p>
  </header>

  <main class="max-w-7xl mx-auto px-6 pb-20">
    <%
      const filteredCrops = crops.filter(crop => {
        return (!filter.state || crop.state === filter.state) &&
               (!filter.trend || crop.demandTrend === filter.trend) &&
               (!filter.season || crop.season === filter.season) &&
               (!filter.grade || crop.grade === filter.grade);
      });
    %>

    <% if (filteredCrops.length === 0) { %>
      <div class="text-center py-20">
        <p class="text-gray-600 text-lg">No crop data available for the selected filters ğŸŒ±</p>
      </div>
    <% } else { %>
      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-8">
        <% filteredCrops.forEach((crop) => { %>
          <div class="bg-white/90 border border-green-100 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-1 transition-all duration-300 overflow-hidden">
            
            <!-- Header -->
            <div class="bg-gradient-to-r from-green-600 to-emerald-500 text-white px-6 py-4">
              <h2 class="text-2xl font-semibold flex items-center gap-2">
                ğŸŒ± <%= crop.crop %>
              </h2>
              <p class="text-sm opacity-90"><%= crop.variety %></p>
            </div>

            <!-- Body -->
            <div class="p-6">
              <!-- Location -->
              <div class="mb-4">
                <p class="text-sm text-gray-600 mb-1">
                  ğŸ“ <strong>City:</strong> <%= crop.city %>, <%= crop.state %>
                </p>
                <p class="text-sm text-gray-600">
                  ğŸ¢ <strong>Mandi:</strong> <%= crop.mandi %>
                </p>
              </div>

              <!-- Price Section -->
              <div class="bg-green-50/70 border border-green-100 p-3 rounded-xl mb-3">
                <p class="text-sm mb-1">ğŸ’° <strong>Min Price:</strong> â‚¹<%= crop.minPrice %> /quintal</p>
                <p class="text-sm mb-1">ğŸ’° <strong>Max Price:</strong> â‚¹<%= crop.maxPrice %> /quintal</p>
                <p class="text-sm mb-1">ğŸ“ˆ <strong>Avg Price:</strong> â‚¹<%= crop.avgPrice %> /quintal</p>
                <p class="text-sm mb-1">ğŸ“Š <strong>Price Change:</strong>
                  <span class="<%= crop.priceChangePercent >= 0 ? 'text-green-700 font-semibold' : 'text-red-600 font-semibold' %>">
                    <%= crop.priceChangePercent %>%</span>
                </p>
                <p class="text-sm">ğŸ“¦ <strong>Quantity Arrived:</strong> <%= crop.quantityArrived %> quintals</p>
              </div>

              <!-- Weather Info -->
              <div class="bg-sky-50 border border-sky-100 p-3 rounded-xl mb-3">
                <h3 class="text-sm font-semibold text-sky-800 mb-1 flex items-center gap-1">ğŸŒ¤ï¸ Weather Info</h3>
                <p class="text-sm mb-1">ğŸŒ¡ï¸ <strong>Temp:</strong> <%= crop.weather.temperature %>Â°C</p>
                <p class="text-sm mb-1">ğŸ’§ <strong>Humidity:</strong> <%= crop.weather.humidity %>%</p>
                <p class="text-sm mb-1">ğŸŒ§ï¸ <strong>Rainfall:</strong> <%= crop.weather.rainfall_mm %> mm</p>
                <p class="text-sm mb-1">ğŸŒˆ <strong>Condition:</strong> <%= crop.weather.condition %></p>
              </div>

              <!-- Demand Trend -->
              <div class="mb-3">
                <p class="text-sm">
                  ğŸ“‰ <strong>Demand Trend:</strong>
                  <span class="<%= crop.demandTrend === 'Increasing'
                      ? 'text-green-600 font-semibold'
                      : crop.demandTrend === 'Decreasing'
                      ? 'text-red-600 font-semibold'
                      : 'text-yellow-600 font-semibold' %>">
                    <%= crop.demandTrend %>
                  </span>
                </p>
              </div>

              <!-- Misc Info -->
              <div class="text-xs text-gray-500 border-t border-gray-200 pt-3 mt-2">
                <p>ğŸ•’ <strong>Last Updated:</strong> <%= crop.lastUpdated %></p>
                <p>ğŸ“… <strong>Date:</strong> <%= crop.date %></p>
              </div>
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>
  </main>

  <%- include("./partials/footer.ejs") %>
</body>
</html>
